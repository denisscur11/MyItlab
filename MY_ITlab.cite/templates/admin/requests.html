{% extends "base.html" %}

{% block title %}Панель Адміністратора - {{ company_info.name }}{% endblock %}

{% block content %}
<section class="page-header">
    <div class="container">
        <h1>Панель Адміністратора</h1>
        <p>Перегляд заявок на консультації та запитів зворотного зв'язку</p>
    </div>
</section>

<section class="admin-panel">
    <div class="container">
        <div class="admin-tabs">
            <button class="tab-button active" data-tab="consultations">Заявки на консультації</button>
            <button class="tab-button" data-tab="contacts">Запити зворотного зв'язку</button>
        </div>
        
        <div class="tab-content active" id="consultations-tab">
            <h2>Заявки на консультації</h2>
            {% if consultation_requests %}
                <div class="admin-table-wrapper">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Дата</th>
                                <th>Ім'я</th>
                                <th>Телефон</th>
                                <th>Email</th>
                                <th>Статус</th>
                                <th>Дії</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for request in consultation_requests %}
                            <tr>
                                <td>{{ request.timestamp }}</td>
                                <td>{{ request.name }}</td>
                                <td>+380 {{ request.phone }}</td>
                                <td>{{ request.email }}</td>
                                <td>
                                    <span class="status-badge new">Новий</span>
                                </td>
                                <td>
                                    <button class="action-button mark-processed" data-id="{{ loop.index0 }}">Опрацьовано</button>
                                    <button class="action-button delete-request" data-id="{{ loop.index0 }}">Видалити</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="no-data-message">Заявок на консультації поки немає.</p>
            {% endif %}
        </div>
        
        <div class="tab-content" id="contacts-tab">
            <h2>Запити зворотного зв'язку</h2>
            {% if contact_requests %}
                <div class="admin-table-wrapper">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Дата</th>
                                <th>Ім'я</th>
                                <th>Телефон</th>
                                <th>Повідомлення</th>
                                <th>Статус</th>
                                <th>Дії</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for request in contact_requests %}
                            <tr>
                                <td>{{ request.timestamp }}</td>
                                <td>{{ request.name }}</td>
                                <td>{{ request.phone }}</td>
                                <td class="message-cell">{{ request.message }}</td>
                                <td>
                                    <span class="status-badge new">Новий</span>
                                </td>
                                <td>
                                    <button class="action-button mark-processed" data-id="{{ loop.index0 }}">Опрацьовано</button>
                                    <button class="action-button delete-request" data-id="{{ loop.index0 }}">Видалити</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="no-data-message">Запитів зворотного зв'язку поки немає.</p>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    .admin-panel {
        padding: 40px 0;
    }
    
    .admin-tabs {
        display: flex;
        margin-bottom: 30px;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .tab-button {
        padding: 12px 20px;
        background: none;
        border: none;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: all 0.3s;
    }
    
    .tab-button.active {
        color: var(--primary-color);
        border-bottom-color: var(--primary-color);
    }
    
    .tab-content {
        display: none;
    }
    
    .tab-content.active {
        display: block;
    }
    
    .admin-table-wrapper {
        overflow-x: auto;
    }
    
    .admin-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    
    .admin-table th,
    .admin-table td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .admin-table th {
        background-color: #f5f5f5;
        font-weight: 600;
    }
    
    .admin-table tr:hover {
        background-color: rgba(255, 107, 0, 0.05);
    }
    
    .status-badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 500;
    }
    
    .status-badge.new {
        background-color: rgba(76, 175, 80, 0.1);
        color: #4CAF50;
    }
    
    .status-badge.processed {
        background-color: rgba(158, 158, 158, 0.1);
        color: #757575;
    }
    
    .action-button {
        padding: 6px 12px;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        margin-right: 5px;
        transition: all 0.2s;
    }
    
    .mark-processed {
        background-color: #4CAF50;
        color: white;
    }
    
    .delete-request {
        background-color: #F44336;
        color: white;
    }
    
    .mark-processed:hover {
        background-color: #388E3C;
    }
    
    .delete-request:hover {
        background-color: #D32F2F;
    }
    
    .no-data-message {
        text-align: center;
        padding: 30px;
        color: #757575;
        background-color: #f5f5f5;
        border-radius: 8px;
    }
    
    .message-cell {
        max-width: 300px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Обробка табів
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Видалити активний клас з усіх табів
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Додати активний клас до натиснутого табу
                button.classList.add('active');
                document.getElementById(`${button.dataset.tab}-tab`).classList.add('active');
            });
        });
        
        // Обробка кнопок дій
        const processButtons = document.querySelectorAll('.mark-processed');
        processButtons.forEach(button => {
            button.addEventListener('click', () => {
                const row = button.closest('tr');
                const statusBadge = row.querySelector('.status-badge');
                
                statusBadge.textContent = 'Опрацьовано';
                statusBadge.classList.remove('new');
                statusBadge.classList.add('processed');
                
                button.disabled = true;
                button.textContent = 'Опрацьовано';
            });
        });
        
        // Видалення заявок (в реальному проекті тут був би AJAX запит)
        const deleteButtons = document.querySelectorAll('.delete-request');
        deleteButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (confirm('Ви впевнені, що хочете видалити цю заявку?')) {
                    button.closest('tr').remove();
                }
            });
        });
    });
</script>
{% endblock %} 