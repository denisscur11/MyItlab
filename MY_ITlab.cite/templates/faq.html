{% extends "base.html" %}

{% block title %}Часті Питання (FAQ) - My ITlab{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/faq.css') }}">
<style>
    .faq-hero {
        background: #fff9f5;
        color: var(--text-color);
        padding: 80px 0 40px;
        position: relative;
        overflow: hidden;
        text-align: center;
    }
    
    .faq-hero h1 {
        color: var(--primary-color);
    }
    
    .faq-hero p {
        color: var(--text-color);
    }
    
    .hero-shape {
        display: none;
    }

    .faq-ask-question {
        background-color: transparent;
        padding: 40px;
        text-align: center;
        border-radius: 0;
        margin-top: 60px;
        box-shadow: none;
        border: none;
    }
</style>
{% endblock %}

{% block content %}
<section class="faq-hero">
    <div class="container">
        <h1>Часті Питання</h1>
        <p>Тут ви знайдете відповіді на найпоширеніші запитання про нашу школу та навчальні курси</p>
    </div>
</section>

<div class="faq-container">
    <div class="faq-search">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="faq-search-input" placeholder="Шукайте питання або ключові слова...">
    </div>
    
    {% if faq_items %}
    <div class="faq-list">
        {% for item in faq_items %}
        <div class="faq-item">
            <button class="faq-question">
                {{ item.question }}
                <span class="faq-toggle">+</span>
            </button>
            <div class="faq-answer">
                <div class="faq-answer-inner">
                    <p>{{ item.answer|safe }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="no-faq-items">Наразі немає питань у цьому розділі. Якщо у вас є запитання, будь ласка, зв'яжіться з нами.</p>
    {% endif %}
    
    <div class="faq-ask-question">
        <h3>Не знайшли відповідь на своє питання?</h3>
        <p>Наша команда підтримки готова допомогти вам. Заповніть форму, і ми зв'яжемося з вами протягом одного робочого дня.</p>
        <a href="{{ url_for('ask_question_page') }}" class="ask-button">Задати питання</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Функціональність розгортання/згортання відповідей
        const faqQuestions = document.querySelectorAll('.faq-question');
        
        faqQuestions.forEach(question => {
            question.addEventListener('click', function() {
                const answer = this.nextElementSibling;
                const answerInner = answer.querySelector('.faq-answer-inner');
                
                // Перевіряємо, чи питання вже активне
                const isActive = this.classList.contains('active');
                
                // Закриваємо всі відкриті питання
                faqQuestions.forEach(q => {
                    if (q !== this) {
                        q.classList.remove('active');
                        const otherAnswer = q.nextElementSibling;
                        otherAnswer.style.maxHeight = '0';
                    }
                });
                
                // Відкриваємо/закриваємо поточне питання
                if (!isActive) {
                    this.classList.add('active');
                    answer.style.maxHeight = answerInner.offsetHeight + 'px';
                } else {
                    this.classList.remove('active');
                    answer.style.maxHeight = '0';
                }
            });
        });
        
        // Функціональність пошуку
        const searchInput = document.getElementById('faq-search-input');
        const faqItems = document.querySelectorAll('.faq-item');
        
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question').textContent.toLowerCase();
                const answer = item.querySelector('.faq-answer-inner').textContent.toLowerCase();
                
                if (question.includes(searchTerm) || answer.includes(searchTerm) || searchTerm === '') {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Показуємо повідомлення, якщо нічого не знайдено
            const visibleItems = document.querySelectorAll('.faq-item[style="display: block"]');
            const noResults = document.querySelector('.no-results');
            
            if (visibleItems.length === 0 && searchTerm !== '') {
                if (!noResults) {
                    const noResultsEl = document.createElement('p');
                    noResultsEl.className = 'no-results';
                    noResultsEl.textContent = 'Нічого не знайдено за вашим запитом. Спробуйте інші ключові слова або задайте питання через форму нижче.';
                    
                    const faqList = document.querySelector('.faq-list');
                    faqList.after(noResultsEl);
                }
            } else if (noResults) {
                noResults.remove();
            }
        });
        
        // Відкриваємо перше питання при завантаженні сторінки
        if (faqQuestions.length > 0) {
            faqQuestions[0].click();
        }
    });
</script>
{% endblock %}